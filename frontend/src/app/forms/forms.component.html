<div class="forms-container">
  <div class="forms-header">
    <h1>Formul√°rios</h1>
    <button class="create-btn"
            (click)="createNewForm()">
      <span>+</span> Novo Formul√°rio
    </button>
  </div>

  <!-- Estado vazio -->
  @if(forms.length === 0){
  <div class="empty-state">
    <div class="empty-icon">üìù</div>
    <h2>Nenhum formul√°rio criado</h2>
    <p>Crie seu primeiro formul√°rio para come√ßar a coletar respostas</p>
    <button class="cta-button"
            (click)="createNewForm()">
      Criar Primeiro Formul√°rio
    </button>
  </div>
  }

  <!-- Tabela de formul√°rios -->
  @if(forms.length > 0){
  <div class="forms-table-container">
    <table class="forms-table">
      <thead>
        <tr>
          <th>T√≠tulo</th>
          <th>Descri√ß√£o</th>
          <th>Perguntas</th>
          <th>Respostas</th>
          <th>Criado em</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let form of forms"
            class="form-row">
          <td class="form-title"
              (click)="viewForm(form)">
            <strong>{{ form.title }}</strong>
          </td>
          <td class="form-description">
            {{ form.description || 'Sem descri√ß√£o' }}
          </td>
          <td class="form-questions">
            {{ form.questions.length }}
          </td>
          <td class="form-responses">
            {{ form.responses || 0 }}
          </td>
          <td class="form-date">
            {{ formatDate(form.createdAt) }}
          </td>
          <td class="form-actions">
            <div class="actions-dropdown">
              <button class="actions-btn"
                      (click)="toggleDropdown(form.id, $event)">
                ‚ãÆ
              </button>
              <div class="dropdown-menu"
                   *ngIf="showDropdownId === form.id"
                   [ngStyle]="getDropdownStyle()">
                <button class="dropdown-item"
                        (click)="viewForm(form)">
                  <span class="item-icon">üëÅÔ∏è</span>
                  Visualizar
                </button>
                <button class="dropdown-item"
                        (click)="copyFormLink(form)">
                  <span class="item-icon">üîó</span>
                  Copiar Link
                </button>
                <button class="dropdown-item delete"
                        (click)="deleteForm(form)">
                  <span class="item-icon">üóëÔ∏è</span>
                  Excluir
                </button>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  }

  <!-- Modal de visualiza√ß√£o do formul√°rio -->
  @if(showFormModal){
  <div class="modal-overlay"
       (click)="closeModal()">
    <div class="modal-content"
         (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ selectedForm?.title }}</h2>
        <button class="close-btn"
                (click)="closeModal()">‚úï</button>
      </div>

      <div class="modal-body">
        <div *ngIf="selectedForm?.description"
             class="form-description-modal">
          <h3>Descri√ß√£o</h3>
          <p>{{ selectedForm?.description }}</p>
        </div>

        <div class="form-questions-modal">
          <h3>Perguntas ({{ selectedForm?.questions?.length || 0 }})</h3>

          <div *ngFor="let question of selectedForm?.questions; let i = index"
               class="question-preview">
            <div class="question-header-preview">
              <span class="question-number-preview">{{ i + 1 }}</span>
              <span class="question-type-badge">{{ getQuestionTypeLabel(question.type) }}</span>
              <span *ngIf="question.required"
                    class="required-badge">Obrigat√≥ria</span>
            </div>

            <h4>{{ question.title }}</h4>

            <div *ngIf="question.options && question.options.length > 0"
                 class="question-options-preview">
              <p><strong>Op√ß√µes:</strong></p>
              <ul>
                <li *ngFor="let option of question.options">{{ option }}</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="secondary-btn"
                (click)="selectedForm && copyFormLink(selectedForm)">
          üîó Copiar Link
        </button>
        <button class="primary-btn"
                (click)="closeModal()">
          Fechar
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Modal de confirma√ß√£o de exclus√£o -->
  @if(showDeleteModal){
  <div class="modal-overlay"
       (click)="closeDeleteModal()">
    <div class="modal-content delete-modal"
         (click)="$event.stopPropagation()">
      <div class="modal-header">
        <div class="delete-icon">üóëÔ∏è</div>
        <h2>Confirmar Exclus√£o</h2>
        <button class="close-btn"
                (click)="closeDeleteModal()">‚úï</button>
      </div>

      <div class="modal-body">
        <p class="delete-message">
          Tem certeza que deseja excluir o formul√°rio
          <strong>"{{ formToDelete?.title }}"</strong>?
        </p>
        <p class="delete-warning">
          Esta a√ß√£o n√£o pode ser desfeita. Todos os dados relacionados a este formul√°rio ser√£o perdidos permanentemente.
        </p>
      </div>

      <div class="modal-footer">
        <button class="secondary-btn"
                (click)="closeDeleteModal()">
          Cancelar
        </button>
        <button class="danger-btn"
                (click)="confirmDeleteForm()">
          Excluir Formul√°rio
        </button>
      </div>
    </div>
  </div>
  }
</div>