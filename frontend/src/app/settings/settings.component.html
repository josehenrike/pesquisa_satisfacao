<div class="settings-container">
  <div class="settings-header">
    <h1>‚öôÔ∏è Configura√ß√µes</h1>
    <p>Gerencie as configura√ß√µes da sua empresa e conta</p>
  </div>

  <!-- Navega√ß√£o por abas -->
  <div class="tabs-navigation">
    <button class="tab-btn"
            [class.active]="activeTab === 'empresa'"
            (click)="setActiveTab('empresa')">
      üè¢ Empresa
    </button>
    <button class="tab-btn"
            [class.active]="activeTab === 'admin'"
            (click)="setActiveTab('admin')">
      üë§ Administrador
    </button>
    <button class="tab-btn"
            [class.active]="activeTab === 'personalizacao'"
            (click)="setActiveTab('personalizacao')">
      üé® Personaliza√ß√£o
    </button>
  </div>

  <!-- Conte√∫do das abas -->
  <div class="tab-content">

    <!-- ABA: EMPRESA -->
    @if(activeTab === 'empresa'){
    <div class="tab-panel">
      <div class="section-card">
        <div class="section-header">
          <h2>üìã Informa√ß√µes da Empresa</h2>
          <p>Dados b√°sicos da sua empresa</p>
        </div>

        <form (ngSubmit)="salvarEmpresa()"
              #empresaForm="ngForm">
          <div class="form-grid">
            <div class="form-group">
              <label for="nomeEmpresa">Nome da Empresa *</label>
              <input type="text"
                     id="nomeEmpresa"
                     [(ngModel)]="empresa.nome"
                     name="nomeEmpresa"
                     required
                     placeholder="Digite o nome da empresa">
            </div>

            <div class="form-group">
              <label for="cnpj">CNPJ *</label>
              <input type="text"
                     id="cnpj"
                     [(ngModel)]="empresa.cnpj"
                     name="cnpj"
                     required
                     placeholder="00.000.000/0000-00">
            </div>

            <div class="form-group">
              <label for="razaoSocial">Raz√£o Social</label>
              <input type="text"
                     id="razaoSocial"
                     [(ngModel)]="empresa.razaoSocial"
                     name="razaoSocial"
                     placeholder="Raz√£o social da empresa">
            </div>

            <div class="form-group">
              <label for="telefoneEmpresa">Telefone</label>
              <input type="text"
                     id="telefoneEmpresa"
                     [(ngModel)]="empresa.telefone"
                     name="telefoneEmpresa"
                     placeholder="(00) 0000-0000">
            </div>

            <div class="form-group">
              <label for="emailEmpresa">Email de Contato</label>
              <input type="email"
                     id="emailEmpresa"
                     [(ngModel)]="empresa.email"
                     name="emailEmpresa"
                     placeholder="contato@empresa.com">
            </div>

            <div class="form-group">
              <label for="website">Website</label>
              <input type="text"
                     id="website"
                     [(ngModel)]="empresa.website"
                     name="website"
                     placeholder="www.empresa.com">
            </div>
          </div>

          <!-- Logo da empresa -->
          <div class="form-group">
            <label>Logo da Empresa</label>
            <div class="file-upload-area">
              <input type="file"
                     id="logoEmpresa"
                     accept="image/*"
                     (change)="onFileSelected($event, 'logo')"
                     style="display: none;">
              <label for="logoEmpresa"
                     class="upload-btn">
                üìÅ Escolher Logo
              </label>
              @if(empresa.logo){
              <div class="logo-preview">
                <img [src]="empresa.logo"
                     alt="Logo da empresa">
              </div>
              }
            </div>
          </div>

          <!-- Endere√ßo -->
          <div class="section-divider">
            <h3>üìç Endere√ßo</h3>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label for="cep">CEP</label>
              <div class="input-with-button">
                <input type="text"
                       id="cep"
                       [(ngModel)]="empresa.endereco.cep"
                       name="cep"
                       placeholder="00000-000">
                <button type="button"
                        class="search-btn"
                        (click)="buscarCEP()">
                  üîç
                </button>
              </div>
            </div>

            <div class="form-group">
              <label for="rua">Rua/Avenida</label>
              <input type="text"
                     id="rua"
                     [(ngModel)]="empresa.endereco.rua"
                     name="rua"
                     placeholder="Nome da rua">
            </div>

            <div class="form-group">
              <label for="numero">N√∫mero</label>
              <input type="text"
                     id="numero"
                     [(ngModel)]="empresa.endereco.numero"
                     name="numero"
                     placeholder="123">
            </div>

            <div class="form-group">
              <label for="complemento">Complemento</label>
              <input type="text"
                     id="complemento"
                     [(ngModel)]="empresa.endereco.complemento"
                     name="complemento"
                     placeholder="Sala, bloco, etc">
            </div>

            <div class="form-group">
              <label for="bairro">Bairro</label>
              <input type="text"
                     id="bairro"
                     [(ngModel)]="empresa.endereco.bairro"
                     name="bairro"
                     placeholder="Nome do bairro">
            </div>

            <div class="form-group">
              <label for="cidade">Cidade</label>
              <input type="text"
                     id="cidade"
                     [(ngModel)]="empresa.endereco.cidade"
                     name="cidade"
                     placeholder="Nome da cidade">
            </div>

            <div class="form-group">
              <label for="estado">Estado</label>
              <select id="estado"
                      [(ngModel)]="empresa.endereco.estado"
                      name="estado">
                <option value="">Selecione...</option>
                <option value="AC">Acre</option>
                <option value="AL">Alagoas</option>
                <option value="AP">Amap√°</option>
                <option value="AM">Amazonas</option>
                <option value="BA">Bahia</option>
                <option value="CE">Cear√°</option>
                <option value="DF">Distrito Federal</option>
                <option value="ES">Esp√≠rito Santo</option>
                <option value="GO">Goi√°s</option>
                <option value="MA">Maranh√£o</option>
                <option value="MT">Mato Grosso</option>
                <option value="MS">Mato Grosso do Sul</option>
                <option value="MG">Minas Gerais</option>
                <option value="PA">Par√°</option>
                <option value="PB">Para√≠ba</option>
                <option value="PR">Paran√°</option>
                <option value="PE">Pernambuco</option>
                <option value="PI">Piau√≠</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="RN">Rio Grande do Norte</option>
                <option value="RS">Rio Grande do Sul</option>
                <option value="RO">Rond√¥nia</option>
                <option value="RR">Roraima</option>
                <option value="SC">Santa Catarina</option>
                <option value="SP">S√£o Paulo</option>
                <option value="SE">Sergipe</option>
                <option value="TO">Tocantins</option>
              </select>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit"
                    class="save-btn"
                    [disabled]="loadingEmpresa || !empresaForm.valid">
              @if(loadingEmpresa){
              <span>‚è≥ Salvando...</span>
              }
              @if(!loadingEmpresa){
              <span>üíæ Salvar Dados da Empresa</span>
              }
            </button>
          </div>
        </form>
      </div>
    </div>
    }

    <!-- ABA: ADMINISTRADOR -->
    @if(activeTab === 'admin'){
    <div class="tab-panel">
      <div class="section-card">
        <div class="section-header">
          <h2>üë®‚Äçüíº Dados do Administrador</h2>
          <p>Informa√ß√µes do respons√°vel pela conta</p>
        </div>

        <form (ngSubmit)="salvarAdmin()"
              #adminForm="ngForm">
          <div class="form-grid">
            <div class="form-group">
              <label for="nomeAdmin">Nome Completo *</label>
              <input type="text"
                     id="nomeAdmin"
                     [(ngModel)]="admin.nome"
                     name="nomeAdmin"
                     required
                     placeholder="Digite seu nome completo">
            </div>

            <div class="form-group">
              <label for="emailAdmin">Email *</label>
              <input type="email"
                     id="emailAdmin"
                     [(ngModel)]="admin.email"
                     name="emailAdmin"
                     required
                     placeholder="seu@email.com">
            </div>

            <div class="form-group">
              <label for="telefoneAdmin">Telefone</label>
              <input type="text"
                     id="telefoneAdmin"
                     [(ngModel)]="admin.telefone"
                     name="telefoneAdmin"
                     placeholder="(00) 00000-0000">
            </div>

            <div class="form-group">
              <label for="cargo">Cargo</label>
              <input type="text"
                     id="cargo"
                     [(ngModel)]="admin.cargo"
                     name="cargo"
                     placeholder="Seu cargo na empresa">
            </div>
          </div>

          <div class="form-actions">
            <button type="submit"
                    class="save-btn"
                    [disabled]="loadingAdmin || !adminForm.valid">
              <span *ngIf="loadingAdmin">‚è≥ Salvando...</span>
              <span *ngIf="!loadingAdmin">üíæ Salvar Dados do Admin</span>
            </button>
          </div>
        </form>
      </div>

      <!-- Se√ß√£o de Altera√ß√£o de Senha -->
      <div class="section-card">
        <div class="section-header">
          <h2>üîê Seguran√ßa da Conta</h2>
          <p>Gerencie a seguran√ßa da sua conta</p>
        </div>

        <div class="security-actions">
          <button class="secondary-btn"
                  (click)="showPasswordChange = !showPasswordChange">
            üîë Alterar Senha
          </button>
        </div>

        @if(showPasswordChange){
        <div class="password-change-form">
          <form (ngSubmit)="alterarSenha()"
                #passwordForm="ngForm">
            <div class="form-group">
              <label for="senhaAtual">Senha Atual</label>
              <input type="password"
                     id="senhaAtual"
                     [(ngModel)]="passwordData.senhaAtual"
                     name="senhaAtual"
                     required
                     placeholder="Digite sua senha atual">
            </div>

            <div class="form-group">
              <label for="novaSenha">Nova Senha</label>
              <input type="password"
                     id="novaSenha"
                     [(ngModel)]="passwordData.novaSenha"
                     name="novaSenha"
                     required
                     minlength="6"
                     placeholder="Digite a nova senha">
            </div>

            <div class="form-group">
              <label for="confirmarSenha">Confirmar Nova Senha</label>
              <input type="password"
                     id="confirmarSenha"
                     [(ngModel)]="passwordData.confirmarSenha"
                     name="confirmarSenha"
                     required
                     placeholder="Confirme a nova senha">
            </div>

            <div class="form-actions">
              <button type="button"
                      class="cancel-btn"
                      (click)="showPasswordChange = false">
                Cancelar
              </button>
              <button type="submit"
                      class="save-btn"
                      [disabled]="!passwordForm.valid">
                üîí Alterar Senha
              </button>
            </div>
          </form>
        </div>
        }
      </div>
    </div>
    }

    <!-- ABA: PERSONALIZA√á√ÉO -->
    @if(activeTab === 'personalizacao'){
    <div class="tab-panel">
      <div class="section-card">
        <div class="section-header">
          <h2>üé® Personaliza√ß√£o</h2>
          <p>Customize a apar√™ncia dos seus formul√°rios</p>
        </div>

        <form (ngSubmit)="salvarPersonalizacao()"
              #personalizacaoForm="ngForm">
          <!-- Cores da marca -->
          <div class="section-divider">
            <h3>üåà Cores da Marca</h3>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label for="corPrimaria">Cor Prim√°ria</label>
              <div class="color-input-group">
                <input type="color"
                       id="corPrimaria"
                       [(ngModel)]="personalizacao.corPrimaria"
                       name="corPrimaria">
                <input type="text"
                       [(ngModel)]="personalizacao.corPrimaria"
                       placeholder="#667eea">
              </div>
            </div>

            <div class="form-group">
              <label for="corSecundaria">Cor Secund√°ria</label>
              <div class="color-input-group">
                <input type="color"
                       id="corSecundaria"
                       [(ngModel)]="personalizacao.corSecundaria"
                       name="corSecundaria">
                <input type="text"
                       [(ngModel)]="personalizacao.corSecundaria"
                       placeholder="#764ba2">
              </div>
            </div>
          </div>

          <!-- Logo para formul√°rios -->
          <div class="form-group">
            <label>Logo para Formul√°rios</label>
            <div class="file-upload-area">
              <input type="file"
                     id="logoFormularios"
                     accept="image/*"
                     (change)="onFileSelected($event, 'logoFormularios')"
                     style="display: none;">
              <label for="logoFormularios"
                     class="upload-btn">
                üìÅ Escolher Logo
              </label>
              @if(personalizacao.logoFormularios){
              <div class="logo-preview">
                <img [src]="personalizacao.logoFormularios"
                     alt="Logo dos formul√°rios">
              </div>
              }
            </div>
          </div>

          <!-- Textos padr√£o -->
          <div class="section-divider">
            <h3>üìù Textos Padr√£o</h3>
          </div>

          <div class="form-group">
            <label for="mensagemBoasVindas">Mensagem de Boas-vindas</label>
            <textarea id="mensagemBoasVindas"
                      [(ngModel)]="personalizacao.mensagemBoasVindas"
                      name="mensagemBoasVindas"
                      rows="3"
                      placeholder="Texto exibido no in√≠cio dos formul√°rios"></textarea>
          </div>

          <div class="form-group">
            <label for="textoAgradecimento">Texto de Agradecimento</label>
            <textarea id="textoAgradecimento"
                      [(ngModel)]="personalizacao.textoAgradecimento"
                      name="textoAgradecimento"
                      rows="3"
                      placeholder="Texto exibido ap√≥s envio do formul√°rio"></textarea>
          </div>

          <div class="form-group">
            <label for="rodapeFormularios">Rodap√© dos Formul√°rios</label>
            <textarea id="rodapeFormularios"
                      [(ngModel)]="personalizacao.rodapeFormularios"
                      name="rodapeFormularios"
                      rows="2"
                      placeholder="Texto exibido no final dos formul√°rios"></textarea>
          </div>

          <!-- Tema -->
          <div class="section-divider">
            <h3>üåô Tema</h3>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox"
                     [(ngModel)]="personalizacao.temaEscuro"
                     name="temaEscuro">
              <span class="checkmark"></span>
              Ativar tema escuro
            </label>
          </div>

          <div class="form-actions">
            <button type="submit"
                    class="save-btn"
                    [disabled]="loadingPersonalizacao">
              @if(loadingPersonalizacao){
              <span>‚è≥ Salvando...</span>
              }
              @if(!loadingPersonalizacao){
              <span>üíæ Salvar Personaliza√ß√£o</span>
              }
            </button>
          </div>
        </form>
      </div>
    </div>
    }
  </div>
</div>